https://chatgpt.com/share/e/68fb3a19-81c0-8013-b2bf-594e1e9a4dbe

=SUMA(G2:G50)
=INDEKS(D:D; PODAJ.POZYCJĘ(MAX(G:G); G:G; 0))

=JEŻELI.BŁĄD(
  INDEKS(
    USUŃ.ZBĘDNE.ODSTĘPY(PODSTAW($E$2:$E$100;ZNAK(160);" "));
    PODAJ.POZYCJĘ(
      0;
      LICZ.JEŻELI($J$1:J1;USUŃ.ZBĘDNE.ODSTĘPY(PODSTAW($E$2:$E$100;ZNAK(160);" ")));
      0
    )
  );
  ""
)
----------
=INDEKS($D$2:$D$100;
  PODAJ.POZYCJĘ(
    MAX(
      JEŻELI(
        USUŃ.ZBĘDNE.ODSTĘPY(PODSTAW($E$2:$E$100;ZNAK(160);" "))=J2;
        JEŻELI.BŁĄD(
          WARTOŚĆ(PODSTAW(PODSTAW(PODSTAW(PODSTAW($G$2:$G$100;"$";"");" ";"");ZNAK(160);"");",";""));
          0
        )
      )
    );
    JEŻELI(
      USUŃ.ZBĘDNE.ODSTĘPY(PODSTAW($E$2:$E$100;ZNAK(160);" "))=J2;
      JEŻELI.BŁĄD(
        WARTOŚĆ(PODSTAW(PODSTAW(PODSTAW(PODSTAW($G$2:$G$100;"$";"");" ";"");ZNAK(160);"");",";""));
        0
      )
    );
    0
  )
)
----=JEŻELI.BŁĄD(
  INDEKS($D$6:$D$100;
    AGREGUJ(
      15; 6;
      (WIERSZ($D$6:$D$100)-WIERSZ($D$6)+1) /
      (
        (
          SUMA.WARUNKÓW(
            $G$6:$G$100;
            $D$6:$D$100;$D$6:$D$100;
            $E$6:$E$100;
            INDEKS($E$6:$E$100;
              AGREGUJ(
                15;6;
                (WIERSZ($E$6:$E$100)-WIERSZ($E$6)+1) /
                (PODAJ.POZYCJĘ($E$6:$E$100;$E$6:$E$100;0)=WIERSZ($E$6:$E$100)-WIERSZ($E$6)+1);
                WIERSZ(A1)
              )
            )
          )
          =
          MAX(
            SUMA.WARUNKÓW(
              $G$6:$G$100;
              $D$6:$D$100;$D$6:$D$100;
              $E$6:$E$100;
              INDEKS($E$6:$E$100;
                AGREGUJ(
                  15;6;
                  (WIERSZ($E$6:$E$100)-WIERSZ($E$6)+1) /
                  (PODAJ.POZYCJĘ($E$6:$E$100;$E$6:$E$100;0)=WIERSZ($E$6:$E$100)-WIERSZ($E$6)+1);
                  WIERSZ(A1)
                )
              )
            )
          )
        )
        *
        (PODAJ.POZYCJĘ($D$6:$D$100;$D$6:$D$100;0)=WIERSZ($D$6:$D$100)-WIERSZ($D$6)+1)
      );
      1
    )
  );
""
)
----------
Sub OczyscDatyIDodajKolumne()
    Dim ws As Worksheet
    Set ws = ActiveSheet

    Dim lastRow As Long
    lastRow = ws.Cells(ws.Rows.Count, "E").End(xlUp).Row

    Dim lastCol As Long
    lastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column
    Dim outputCol As Long
    outputCol = lastCol + 1

    ' Dodaj nagłówek
    ws.Cells(1, outputCol).Value = "Data (mm/dd/yyyy)"

    Dim i As Long
    For i = 2 To lastRow
        Dim rawDate As Variant
        rawDate = ws.Cells(i, 5).Value  ' Kolumna E = 5

        If IsDate(rawDate) Then
            ws.Cells(i, outputCol).Value = Format(CDate(rawDate), "mm/dd/yyyy")
        Else
            ws.Cells(i, outputCol).Value = "Błąd daty"
        End If
    Next i

    MsgBox "Daty zostały przekształcone i dodane do kolumny " & ws.Cells(1, outputCol).Address(False, False), vbInformation
End Sub
----------- poprawiona data-------
Sub OczyscDatyIDodajKolumne()
    Dim ws As Worksheet
    Set ws = ActiveSheet

    Dim lastRow As Long
    lastRow = ws.Cells(ws.Rows.Count, "E").End(xlUp).Row

    Dim lastCol As Long
    lastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column
    Dim outputCol As Long
    outputCol = lastCol + 1

    ' Nagłówek
    ws.Cells(1, outputCol).Value = "Data (dd/mm/yyyy)"

    ' KLUCZ: wymuszenie ukośników jako literałów
    ws.Columns(outputCol).NumberFormat = "dd\/mm\/yyyy"

    Dim i As Long
    For i = 2 To lastRow
        Dim rawDate As Variant
        rawDate = ws.Cells(i, 5).Value  ' Kolumna E

        If IsDate(rawDate) Then
            ws.Cells(i, outputCol).Value = CDate(rawDate) ' przechowuj jako datę
        Else
            ws.Cells(i, outputCol).Value = "Błąd daty"
        End If
    Next i

    MsgBox "Daty zostały przekształcone i dodane do kolumny " & ws.Cells(1, outputCol).Address(False, False), vbInformation
End Sub
-----------

chat - diagramy csv: https://chatgpt.com/g/g-68fb6c3047fc8191a1cd35db3ce12489-asystent-do-tworzenia-diagramow
------
api nbp:
https://api.nbp.pl/api/exchangerates/rates/A/usd/

https://chatgpt.com/g/g-68fb6fd64a648191aed81cbc66aba069-nbp-asystent-dla-api-nbp
werja z plikiem: https://chatgpt.com/g/g-68fb740f80b081919824341c4683f3c4-api-nbp-z-pliku